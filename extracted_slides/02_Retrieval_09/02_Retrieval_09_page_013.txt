训练双塔模型

• 从点击数据中随机抽取 n 个用户—物品二元组，组成一个 batch。

• 双塔模型的损失函数：

  L_main[i] = -log(exp(cos(aᵢ,bᵢ)-log pᵢ)/∑ⁿⱼ₌₁ exp(cos(aᵢ,bⱼ)-log pⱼ))
  对应用户i

• 做梯度下降，减小损失函数：
  
  1/n ∑ⁿᵢ₌₁ L_main[i]