训练模型

• 从全体物品中均匀抽样，得到 m 个物品，作为一个 batch。

• 做两类特征变换，物品塔输出两组向量：

b'₁, b'₂, ···, b'ₘ  和  b''₁, b''₂, ···, b''ₘ

• 第 i 个物品的损失函数：

L_self[i] = -log(exp(cos(b'ᵢ,b''ᵢ))/∑ⱼ₌₁ᵐ exp(cos(b'ᵢ,b''ⱼ)))