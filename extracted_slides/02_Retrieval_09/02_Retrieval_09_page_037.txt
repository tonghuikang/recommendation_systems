训练模型

• 对点击做随机抽样，得到 n 对用户—物品二元组，作为一个 batch。

• 从全体物品中均匀抽样，得到 m 个物品，作为一个 batch。

• 做梯度下降，使得损失减小：

1/n ∑ⁿᵢ₌₁ L_main[i] + α · 1/m ∑ᵐⱼ₌₁ L_self[j]

双塔模型的损失        自监督学习的损失